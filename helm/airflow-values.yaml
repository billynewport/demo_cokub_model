# Airflow Helm Values for Remote Kubernetes Cluster (cokub-master)
# Airflow metadata DB on postgresaf-co, merge DB on postgres-co

executor: CeleryExecutor

# Airflow version
images:
  airflow:
    repository: apache/airflow
    tag: "3.1.6"

# External PostgreSQL on postgresaf-co
postgresql:
  enabled: false

data:
  metadataConnection:
    user: postgres
    pass: password
    protocol: postgresql
    host: postgresaf-co
    port: 5432
    db: airflow_db

# Redis for Celery broker
redis:
  enabled: true
  persistence:
    enabled: true
    storageClassName: longhorn

# Single scheduler
scheduler:
  replicas: 1

# Single worker
workers:
  replicas: 1
  persistence:
    enabled: true
    storageClassName: longhorn

# API server with NodePort for access
apiServer:
  service:
    type: NodePort

# DAG processor
dagProcessor:
  enabled: true

# Triggerer for async sensors
triggerer:
  enabled: true

# GitSync for DAGs - pulls from GitHub repository
dags:
  persistence:
    enabled: false
  gitSync:
    enabled: true
    repo: https://github.com/billynewport/demo_cokub_airflow.git
    branch: main
    subPath: dags
    wait: 60
    credentialsSecret: git-dags

# Logs persistence
logs:
  persistence:
    enabled: true
    storageClassName: longhorn
    size: 5Gi

config:
  logging:
    delete_local_logs: "False"
  scheduler:
    dag_dir_list_interval: "60"

# Web UI credentials
webserver:
  defaultUser:
    enabled: true
    username: admin
    password: admin
